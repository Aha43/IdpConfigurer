@page "/Idp/{IdpName}/Client/{ClientId}"

<MudText Typo="Typo.h3">Client</MudText>

<MudStack>
    <MudText Typo="Typo.h5">@ViewController.Client?.ClientName</MudText>
    <MudExpansionPanels>
        <MudExpansionPanel Text="Settings">
            <MudStack>
                <MudCheckBox @bind-Checked="ViewController.AllowOfflineAccess" Label="AllowOfflineAccess"/>
                <MudCheckBox @bind-Checked="ViewController.AlwaysIncludeUserClaimsInIdToken" Label="AlwaysIncludeUserClaimsInIdToken" />
                <MudButton OnClick="ViewController.SaveSettings">Save</MudButton>
            </MudStack>
        </MudExpansionPanel>
        <MudExpansionPanel Text="Grants / Flows">
            <MudStack>
                <MudStack>
                    <MudCheckBox @bind-Checked="ViewController.Hybrid" Label="Hybrid" />
                    <MudCheckBox @bind-Checked="ViewController.ResourceOwnerPassword" Label="Password" />
                    <MudCheckBox @bind-Checked="ViewController.Implicit" Label="Implicit" />
                    <MudCheckBox @bind-Checked="ViewController.AuthorizationCode" Label="AuthorizationCode" />
                    <MudCheckBox @bind-Checked="ViewController.ClientCredentials" Label="ClientCredentials" />
                </MudStack>
                <MudButton OnClick="ViewController.SaveGrantsFlows">Save</MudButton>
            </MudStack>
        </MudExpansionPanel>
        <MudExpansionPanel Text="Redirect Uris">
            <MudStack>
                <MudStack>
                    <MudTextField @bind-Value="ViewController.NewRedirectUri" Label="Redirect Uri" Variant="Variant.Outlined" Margin="Margin.Dense" />
                    <MudButton OnClick="ViewController.AddRedirectUriAsync">Add</MudButton>
                    @if (ViewController.RedirectUriErrorMessage != null)
                    {
                        <MudText Color="Color.Error">@ViewController.RedirectUriErrorMessage</MudText>
                    }
                </MudStack>
                <MudList>
                    @if (ViewController.Client != null)
                    {
                        foreach (var uri in ViewController.Client.RedirectUris)
                        {
                            <MudListItem>
                                <MudText>@uri</MudText>
                            </MudListItem>
                        }
                    }
                </MudList>
            </MudStack>
        </MudExpansionPanel>
        <MudExpansionPanel Text="APIs">
            <MudStack>
                <MudStack>
                    @for (int i = 0; i<ViewController.SelectedApiScopes.Length; i++)
                    {
                        int k = i;
                        <MudCheckBox @bind-Checked="ViewController.SelectedApiScopes[k].Selected" Label="@ViewController.SelectedApiScopes[i].Title" />
                    }
                </MudStack>
                <MudButton OnClick="ViewController.SaveApiSelection">Save</MudButton>
            </MudStack>
        </MudExpansionPanel>
    </MudExpansionPanels>
</MudStack>
